<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /><title>pg_escape_bytea</title><link rel="stylesheet" href="stylesheet.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.75.2" /><link rel="home" href="index.html" title="Pgtcl Reference Manual" /><link rel="up" href="pgtcl-ref-query.html" title="4.3. Query Execution Commands" /><link rel="prev" href="pg-quote.html" title="pg_quote" /><link rel="next" href="pg-unescape-bytea.html" title="pg_unescape_bytea" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">pg_escape_bytea</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="pg-quote.html">Prev</a> </td><th width="60%" align="center">4.3. Query Execution Commands</th><td width="20%" align="right"> <a accesskey="n" href="pg-unescape-bytea.html">Next</a></td></tr></table><hr /></div><div class="refentry" title="pg_escape_bytea"><a id="pg-escape-bytea"></a><div class="titlepage"></div><div class="refnamediv"><h2><span class="refentrytitle">pg_escape_bytea</span></h2><p>pg_escape_bytea &#8212; Escape a binary string for use in an SQL string constant
with bytea (byte array) columns</p></div><div class="refsynopsisdiv" title="Synopsis"><h2>Synopsis</h2><pre class="synopsis">
pg_escape_bytea ?<span class="optional"><em class="parameter"><code>conn</code></em></span>? <em class="parameter"><code>binary_string</code></em>
</pre></div><div class="refsect1" title="Description"><a id="id2575436"></a><h2>Description</h2><p>
<code class="function">pg_escape_bytea</code> returns its argument with added
characters which makes it safe for use in single-quoted SQL string
constants. Unlike <a class="xref" href="pg-escape-string.html" title="pg_escape_string"><span class="refentrytitle">pg_escape_string</span></a>, which works on
text strings, <code class="function">pg_escape_bytea</code> is meant for
arbitrary binary data meant to be stored or used with
<span class="application">PostgreSQL</span> <code class="literal">bytea</code>
(byte array) columns.
This command allows arbitrary binary data to be safely sent through
the <span class="application">PostgreSQL</span> query mechanism in a
text mode query.
(An alternative to escaping and unescaping binary data is to use binary
mode prepared queries.  See <a class="xref" href="pg-exec-prepared.html" title="pg_exec_prepared"><span class="refentrytitle">pg_exec_prepared</span></a>.)
    </p></div><div class="refsect1" title="Arguments"><a id="id2575488"></a><h2>Arguments</h2><div class="variablelist"><dl><dt><span class="term"><em class="replaceable"><code>conn</code></em></span></dt><dd><p>
            Optional handle of the connection that the binary string should be
            escaped for sending to.
          </p></dd><dt><span class="term"><em class="replaceable"><code>binary_string</code></em></span></dt><dd><p>
            The binary string data to escape. This is just a regular
Tcl string, except that it can contain arbitrary byte values.
          </p></dd></dl></div></div><div class="refsect1" title="Return Value"><a id="id2575530"></a><h2>Return Value</h2><p>
      The escaped data string. When placed in single quotes, it can safely
be used in SQL statements.
    </p></div><div class="refsect1" title="Notes"><a id="id2575542"></a><h2>Notes</h2><p>
      See also <a class="xref" href="pg-unescape-bytea.html" title="pg_unescape_bytea"><span class="refentrytitle">pg_unescape_bytea</span></a>, but note that these
commands are not inverses of each other.
<code class="function">pg_escape_bytea</code> creates output that is meant to go
through two levels of parsing by the database: one when parsing SQL, and
one when processing the bytea data type. For example, a quote mark in the
input string is translated to two quote marks by
<code class="function">pg_escape_bytea</code>, but is not translated back by
<code class="function">pg_unescape_bytea</code>.
    </p><p>
      The <span class="application">pgintcl</span> implementation of this
command is slow. Consider using binary prepared queries instead, to
avoid having to escape and unescape your binary data.
    </p><p>
      This command was added in
      <span class="application">pgtclng-1.5.2</span> and in
      <span class="application">pgintcl-2.2.0</span>.
    </p><p>
      The optional <em class="replaceable"><code>conn</code></em> argument
      was added to this command in
      <span class="application">pgtclng-1.7.0</span> and in
      <span class="application">pgintcl-3.1.0</span>.
    </p><p>
The <em class="replaceable"><code>conn</code></em> argument is used to get the state of
the PostgreSQL server configuration parameter
<em class="parameter"><code>standard_conforming_strings</code></em>.
This is used to determine if backslashes need to be doubled. If the
<em class="replaceable"><code>conn</code></em> parameter is supplied, the setting can
be accurately determined for the specific database connection being used.
(Note that this information is maintained on the client side and does not
necessitate any additional database server traffic.)
    </p><p>
If the <em class="replaceable"><code>conn</code></em> parameter is not supplied, a best
guess will be made based on the most recent information from any database
connection by the client. Therefore, if the client makes a single database
connection, or multiple connections with the same setting for
standard_conforming_strings, there is no need to provide the
<em class="replaceable"><code>conn</code></em> parameter.
    </p><p>
      This command uses or emulates the PostgreSQL
      <span class="application">libpq</span>
      function <code class="function">PQescapeBytea</code>, if no connection handle
      is supplied, or <code class="function">PQescapeByteaConn</code> if a connection
      handle is supplied.
    </p><p>
      See <a class="xref" href="pgtcl-example-picstore-esc.html" title="5.9. Example - Bytea Escaping - Picture Viewer, Part 1 - Store Pictures">Section 5.9, &#8220;Example - Bytea Escaping - Picture Viewer, Part 1 - Store Pictures&#8221;</a> for an example.
    </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pg-quote.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="pgtcl-ref-query.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="pg-unescape-bytea.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">pg_quote </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> pg_unescape_bytea</td></tr></table></div></body></html>
